# 2장 의존성 역전하기

계층형 아키텍처의 대안에 대해 이야기한다.

## 단일 책임 원칙

- '하나의 컴포넌트는 오로지 한가지 일만 해야하고, 그것을 올바르게 수행해야한다'
- 책임을 변경할 이유로 해석하면 이렇게 말할 수 있다. '컴포넌트를 변경하는 이유는 오직 하나 뿐이어야 한다'
- 안타깝게도 변경할 이유는 의존성을 통해 쉽게 전파된다.
- 변경할 이유가 쌓인 후에는 한 컴포넌트를 변경하는 것이 다른 컴포넌트가 실패하는 원인으로 작용할 수 있다.

## 부수효과에 관한 이야기

- 컴포넌트 변경으로 인해 다른 것이 망가지는 경우가 반복되면 컴포넌트 변경을 꺼리게 되고 이상한 방법을 사용하게 된다.

## 의존성 역전 원칙

- 계층형 아키텍처에서 의존성은 항상 아래 방향을 가리킨다. 이로인해 고수준의 계층에서 변경할 이유가 더 많아진다.
- 영속성 계층을 수정하면 의존성때문에 도메인 계층도 수정해야한다. 도메인 계층은 매우 중요하기 때문에 가능하면 바꾸고 싶지 읺다.
- 의존성 역전을 통해서 해결할 수 있다.
- 의존성 역전은 의존성 양쪽을 모두 제어할 수 있을때만 가능하다.
- 도메인 계층에 엔티티를 올리고 리포지토리 인터페이스를 만든다. 이것으로 도메인 -> 영속성으로의 의존성을 해방시킨다.

## 클린 아키텍처

- 클린 아키텍처는 바깥으로 향하는 의존성대신 의존성 역전 원칙의 도움으로 모든 의존성이 도메인 코드를 향하는 것
- 클린 아키텍처에는 대가가 따른다. 도메인 계층이 다른 계층과 분리되어야 하므로 app의 엔티티에 대한 모델을 각 계층에서 유지보수해야한다.
  - 각 계층에서 데이터를 주고 받을때 서로의 엔티티를 변환해야한단는 것이다.
  - 이는 결합을 제거하기때문에 바람직한 것이다.

## 육각형 아키텍처 (헥사고날 아키텍처)

- 육각형 아키텍처는 알리스테어 콕번이 만든 용어
- 유스케이스는 입력포트, 출력포트를 통해 외부와 통신하여 각 포트는 아답터로 구현한다.
  - 이런 핵심개념으로 인해 포트와 어댑터 아키텍처로도 알려져있다.

## 유지보수 가능한 소프트웨어를 만드는데 어떻게 도움이 될까?

- 의존성 역전을 통해 도메인 코드가 바깥쪽에 의존하지 않게 함으로 유지보수성이 좋아진다.
